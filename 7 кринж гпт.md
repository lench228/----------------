**

## 7.1 Сетевой уровень передачи данных. Применение таблицы маршрутизации для пересылки пакетов в сеть назначения. Назначение и структура записей в таблице маршрутизации на маршрутизаторе.

Сетевой уровень выполняет три основные функции: 

- Определяет формат сетевого адреса
    
- Определяет способ построения сетевого маршрута (маршрутизация - Routing) 
    
- Принимает блок данных транспортного уровня и дополняет его необходимыми полями заголовка для маршрутизации по сети
    

  

Пример протокола сетевого уровня – (Internet Protocol, IP) 

  

Само название концепции построения глобальных сетей — Internet происходит от термина Internetworking (объединение сетей). Компонентами Internet являются сети.

Сеть — это связная совокупность конечных или промежуточных узлов имеющих одинаковый адрес сети.

Каждый из узлов данной сети должен иметь уникальный сетевой адрес, который состоит из двух компонентов — адрес сети (Net ID) и адрес узла (Host ID) в данной сети. Адрес узла является уникальным только в пределах данной сети.

Для обеспечения информационного взаимодействия внутри сети может быть использован любой из протоколов канального уровня. Максимальное число узлов в сети определяется типом используемого  протокола сетевого уровня, в данном случае IP. Сеть минимального размера может включать только один узел.

Для обеспечения информационного взаимодействия между сетями используются специальные сетевые компоненты, которые имеют название  маршрутизатор.

  

Маршрутизатор (router) — это специализированная вычислительная ЭВМ, задачей которой является определение участка маршрута, по которому должен быть передан каждый из входящих в него пакетов.

Задачу определения пути, который должен привести данный пакет в пункт его назначения маршрутизатор решает локальным образом — он определяет только номер своего интерфейса, через который этот пакет должен быть отправлен. С точки зрения пользователей сети маршрутизатор представляет собой шлюз, через который обеспечивается информационный обмен с другими сетями. Определение номера порта маршрутизатор производит после анализа своей таблицы маршрутизации, которая ставит во взаимно однозначное соответствие адресу искомой сети номер интерфейса маршрутизатора  или адрес другого маршрутизатора — шлюза. В том случае, если в процессе поиска маршрута, по которому должен следовать далее данный кадр, будет установлено, что он должен быть направлен далее через шлюз G, пакет должен быть отправлен через тот интерфейс данного маршрутизатора, который имеет такой же  адрес сети, как и этот шлюз. Следует отметить, что для обеспечения правильного функционирования системы в целом маршрутизатор должен иметь несколько сетевых (IP) адресов – по одному (как минимум) для каждой подключенной к нему сети.

Таблица маршрутизации может быть построена различными способами. Важно отметить, что для успешного функционирования маршрутизатора его таблица маршрутизации не обязательно должна содержать столько записей, сколько сетей имеется в Internet. В том случае, если не удается определить направление передачи какого либо пакета обычным способом, маршрутизатор передает его в направлении шлюза, который определен в качестве default gateway для данного маршрутизатора. Таким образом, процесс функционирования маршрутизатора имеет четыре основные фазы:

- Извлечение адреса назначения из пакета
    
- Определение сети назначения
    
- Определение интерфейса или шлюза
    
- Отправка пакета
    

  

В таблице маршрутизации для каждой сети назначения указываются: 

- IP адрес сети; 
    
- Номер интерфейса ближайшего к этой сети промежуточного узла — если используется L2 соединение «точка-точка» (P2P); 
    
- IP адрес ближайшего к этой сети промежуточного узла — если используется L2 соединение с множественным доступом (BUS); 
    

  

Оконечные узлы используют упрощенную таблицу маршрутизации, в которой указывается только один IP адрес промежуточного узла (шлюз по умолчанию).

  

В Windows для отображения таблицы маршрутизации ПК используется команда netstat -r

Результат ее выполнения показывает: 

- Сетевой адрес узла 192.168.10.1/24 
    
- Адрес шлюза по умолчанию: 192.168.10.1 
    
- Адрес подключенной сети: 192.168.10.0
    

  

## 7.2 Назначение и основные характеристики протоколов IPv4 и IPv6. Структура пакетов IPv4 и IPv6. Назначение основных полей заголовка пакета IPv4. Назначение основных полей заголовка пакета IPv6.

  

Назначение и основные характеристики протоколов IPv4 и IPv6

  

IPv4 и v6 - это версии протоколов, используемые для адресации и маршрутизации данных в сетях.

  

IPv4:

- Использует 32-битные адреса, что позволяет адресовать примерно 4.3 миллиарда уникальных адресов.
    
- Адреса записываются в десятичной форме с разделением точками (например, 192.168.0.1).
    
- Поддержка фрагментации и сборки пакетов.
    
- Использует протоколы такие как ARP, ICMP, и DHCP.
    

  

IPv6:

- Использует 128-битные адреса, что позволяет адресовать большее, чем IPv4 количество уникальных адресов.
    
- Адреса записываются в шестнадцатеричной форме с разделением двоеточиями.
    
- Заголовок имеет фиксированную длину 40 байт.
    
- Встроенная поддержка безопасности (IPsec).
    
- Нет поддержки фрагментации на маршрутизаторах; фрагментация выполняется только на отправляющем узле.
    

  

Структура пакетов IPv4 и IPv6

  

Заголовок пакета IPv4:

  

- Version (Версия): 4 бита, указывает версию IP (4 для IPv4).
    
- IHL (Internet Header Length): 4 бита, длина заголовка в 32-битных словах.
    
- Type of Service (ToS): 8 бит, параметры качества обслуживания.
    
- Total Length: 16 бит, общая длина пакета.
    
- Identification: 16 бит, используется для идентификации фрагментов одного и того же пакета.
    
- Flags: 3 бита, управление фрагментацией.
    
- Fragment Offset: 13 бит, смещение фрагмента.
    
- Time to Live (TTL): 8 бит, ограничение времени жизни пакета.
    
- Protocol: 8 бит, указывает протокол верхнего уровня (например, TCP, UDP).
    
- Header Checksum: 16 бит, контрольная сумма заголовка.
    
- Source Address 32 бит, IP-адрес отправителя.
    
- Destination Address 32 бит, IP-адрес получателя.
    
- Options (опционально): переменная длина, дополнительные параметры.
    

  

Заголовок пакета IPv6:

- Version (Версия): 4 бита, указывает версию IP (6 для IPv6).
    
- Traffic Class 8 бит, аналогично полю ToS в IPv4.
    
- Flow Label 20 бит, идентификатор потока данных.
    
- Payload Length 16 бит, длина данных после заголовка.
    
- Next Header 8 бит, указывает следующий заголовок (например, заголовок TCP, UDP).
    
- Hop Limit 8 бит, аналогично TTL в IPv4.
    
- Source Address: 128 бит, IP-адрес отправителя.
    
- Destination Address: 128 бит, IP-адрес получателя.
    

  

Основные отличия между IPv4 и IPv6 заключаются в увеличенном адресном пространстве, упрощении заголовка и улучшенной поддержке новых функций, таких как безопасность и автоматическая конфигурация в IPv6.

**
