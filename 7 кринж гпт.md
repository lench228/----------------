**

## 7.1 Сетевой уровень передачи данных. Применение таблицы маршрутизации для пересылки пакетов в сеть назначения. Назначение и структура записей в таблице маршрутизации на маршрутизаторе.

Сетевой уровень выполняет три основные функции: 
- Определяет формат сетевого адреса
- Определяет способ построения сетевого маршрута (маршрутизацию) 
- Принимает блок данных транспортного уровня и дополняет его необходимыми полями заголовка для маршрутизации по сети
  
Пример протокола сетевого уровня – (Internet Protocol, IP) 

Протокол IP принимает блок данных от транспортного уровня (сегмент/дейтаграмма-PDU L3) и помещает его в поле полезной нагрузки своего пакета (PDU L2)

В процессе маршрутизации используются значение полей из этого блока: 
	❖ Source Address 
	❖ Destination Address
	❖ Time To Live 

IP адреса, которые содержатся в этой полезной нагрузке должны быть глобально уникальны и иметь структуру адрес сети + адрес узла = адрес IP

Перед тем как отправить пакет IP каждый сетевой узел сравнивает IP назначения и IP адреса сети отправителя, если они совпадают, то данные уже передаются на физический уровень, тк мы уже находимся в нужной сети. 
Иначе, выполняется маршрутизация пакета по записям в таблице маршрутизации.

При этом маршрутизация происходит через маршрутизатор(промежуточное устройство), оно перенаправит пакет в нужную сеть. Сама маршрутизация выполняется по принципу хоп бай хоп, мы прыгаем от одного маршрутизатора к тому, что ближе к нашей цели назначения, пока не окажемся в нужной сети=. 

В самой самой таблице маршрутизации для каждой сети указываются- 
	IP адрес сети
	Номер интерфейса ближайшего к этой сети промежуточного узла(если используем P2P) 
	IP адрес  ближайшего к этой сети промежуточного узла(если используем BUS)
	 Оконечные узлы используют упрощенную таблицу маршрутизации, в которой указывается только один IP адрес промежуточного узла (шлюз по умолчанию)
	 
Заполняется эта таблица либо динамически с помощью спец алгоритмов или статически вручную через настройку маршрутизаторов. 

В Windows для отображения таблицы ПК используется команда netstat -r
Результат ее выполнения показывает: 
- Сетевой адрес узла 192.168.10.1/24 
- Адрес шлюза по умолчанию: 192.168.10.1 
- Адрес подключенной сети: 192.168.10.0

  

## 7.2 Назначение и основные характеристики протоколов IPv4 и IPv6. Структура пакетов IPv4 и IPv6. Назначение основных полей заголовка пакета IPv4. Назначение основных полей заголовка пакета IPv6.

  

Назначение и основные характеристики протоколов IPv4 и IPv6

  

IPv4 и v6 - это версии протоколов, используемые для адресации и маршрутизации данных в сетях.

  

IPv4:

- Использует 32-битные адреса, что позволяет адресовать примерно 4.3 миллиарда уникальных адресов.
    
- Адреса записываются в десятичной форме с разделением точками (например, 192.168.0.1).
    
- Поддержка фрагментации и сборки пакетов.
    
- Использует протоколы такие как ARP, ICMP, и DHCP.
    

  

IPv6:

- Использует 128-битные адреса, что позволяет адресовать большее, чем IPv4 количество уникальных адресов.
    
- Адреса записываются в шестнадцатеричной форме с разделением двоеточиями.
    
- Заголовок имеет фиксированную длину 40 байт.
    
- Встроенная поддержка безопасности (IPsec).
    
- Нет поддержки фрагментации на маршрутизаторах; фрагментация выполняется только на отправляющем узле.
    

  

Структура пакетов IPv4 и IPv6

  

Заголовок пакета IPv4:

  

- Version (Версия): 4 бита, указывает версию IP (4 для IPv4).
    
- IHL (Internet Header Length): 4 бита, длина заголовка в 32-битных словах.
    
- Type of Service (ToS): 8 бит, параметры качества обслуживания.
    
- Total Length: 16 бит, общая длина пакета.
    
- Identification: 16 бит, используется для идентификации фрагментов одного и того же пакета.
    
- Flags: 3 бита, управление фрагментацией.
    
- Fragment Offset: 13 бит, смещение фрагмента.
    
- Time to Live (TTL): 8 бит, ограничение времени жизни пакета.
    
- Protocol: 8 бит, указывает протокол верхнего уровня (например, TCP, UDP).
    
- Header Checksum: 16 бит, контрольная сумма заголовка.
    
- Source Address 32 бит, IP-адрес отправителя.
    
- Destination Address 32 бит, IP-адрес получателя.
    
- Options (опционально): переменная длина, дополнительные параметры.
    

  

Заголовок пакета IPv6:

- Version (Версия): 4 бита, указывает версию IP (6 для IPv6).
    
- Traffic Class 8 бит, аналогично полю ToS в IPv4.
    
- Flow Label 20 бит, идентификатор потока данных.
    
- Payload Length 16 бит, длина данных после заголовка.
    
- Next Header 8 бит, указывает следующий заголовок (например, заголовок TCP, UDP).
    
- Hop Limit 8 бит, аналогично TTL в IPv4.
    
- Source Address: 128 бит, IP-адрес отправителя.
    
- Destination Address: 128 бит, IP-адрес получателя.
    

  

Основные отличия между IPv4 и IPv6 заключаются в увеличенном адресном пространстве, упрощении заголовка и улучшенной поддержке новых функций, таких как безопасность и автоматическая конфигурация в IPv6.

**
